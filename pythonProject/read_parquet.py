import pandas as pd
import os

file1 = 'C:/Users/A26V/OneDrive - GFT Technologies SE/Documents/Work/ConTe/010.parquet'
file2 = 'C:/Users/A26V/OneDrive - GFT Technologies SE/Documents/Work/ConTe/009.parquet'

file_09 = pd.read_parquet(file1)
file_010 = pd.read_parquet(file2,use_nullable_dtypes=True)

print(file_09)

from pyspark.sql.types import StructType,StructField, StringType, IntegerType, LongType,NullType,TimestampType

schema = {'ab3_07_ania_sita_intermediate_01': StructType([StructField("policyperiod_3ID",LongType(),True),StructField("policyHolderID",LongType(),True),StructField("df_name",StringType(),True)]),
'ab3_07_ania_sita_intermediate_02': StructType([StructField("BranchID",LongType(),True),StructField("vehicleOwnerID",LongType(),True),StructField("df_name",StringType(),True)]),
'ab3_07_ania_sita_intermediate_03': StructType([StructField("Vehicle",LongType(),True),StructField("df_name",StringType(),True)]),
'ab3_07_ania_sita_intermediate_covered_04': StructType([StructField("PolicyNumber",StringType(),True),StructField("TermNumber",IntegerType(),True),StructField("PaymentDueDate",TimestampType(),True),StructField("df_name",StringType(),True)]),
'ab3_07_ania_sita_intermediate_covered_05': StructType([StructField("PolicyNumber",StringType(),True),StructField("TermNumber",IntegerType(),True),StructField("PaymentDate",TimestampType(),True),StructField("df_name",StringType(),True)]),
'ab3_07_ania_sita_intermediate_covered_06': StructType([StructField("PolicyNumber",StringType(),True),StructField("TermNumber",IntegerType(),True),StructField("PaymentDueDate",TimestampType(),True),StructField("df_name",StringType(),True)]),
'ab3_07_ania_sita_intermediate_covered_07': StructType([StructField("BranchID",LongType(),True),StructField("vehicleDriverID",LongType(),True),StructField("df_name",StringType(),True)]),
'ab3_07_ania_sita_intermediate_covered_08': StructType([StructField("id",LongType(),True),StructField("df_name",StringType(),True)]),
'ab3_07_ania_sita_covered_policies': StructType([StructField("policypcID",LongType(),True),StructField("vehicleType_TYPECODE",StringType(),True),StructField("PolicyNumber",StringType(),True),StructField("periodstart",TimestampType(),True),StructField("periodend",TimestampType(),True),StructField("paymentMethodSubtype_TYPECODE",StringType(),True),StructField("iurcode",StringType(),True),StructField("policybcID",LongType(),True),StructField("bc_paymentduedate_PaymentDueDate",TimestampType(),True),StructField("PaymentDate",TimestampType(),True),StructField("EditEffectiveDate",TimestampType(),True),StructField("bc_nextpaymentduedate_PaymentDueDate",TimestampType(),True),StructField("PeriodEnd",TimestampType(),True),StructField("jobSubtype_TYPECODE",StringType(),True),StructField("ChangeVehicleHour",TimestampType(),True),StructField("policyHolder_1_CountryOfBirth_ExtInternal",StringType(),True),StructField("policyHolder_1_TaxIDInternal",StringType(),True),StructField("RegistrationNumber",StringType(),True),StructField("vehicleOwner_1_CountryOfBirth_ExtInternal",StringType(),True),StructField("vehicleOwner_1_TaxIDInternal",StringType(),True),StructField("abbreviation",StringType(),True),StructField("payperiodtype_TYPECODE",StringType(),True),StructField("closeDate",TimestampType(),True),StructField("ref_dts",TimestampType(),True),StructField("gw_ref_month",StringType(),True),StructField("year",StringType(),True),StructField("month",StringType(),True),StructField("day",StringType(),True),StructField("df_name",StringType(),True)]),
'ab3_07_ania_sita_intermediate_triggers_09': StructType([StructField("ID_Policy_PC",LongType(),True),StructField("ID_PolicyPeriod_PC",LongType(),True),StructField("JobNumber",StringType(),True),StructField("Data_Chiusura_Transazione",TimestampType(),True),StructField("PolicyChangeReasonCode",StringType(),True),StructField("Numero_Polizza",StringType(),True),StructField("RegistrationNumber",StringType(),True),StructField("TipoMovimento",NullType(),True),StructField("CausaleMovimento",NullType(),True),StructField("TipoMovimentoPrecedente",NullType(),True),StructField("CausaleMovimentoPrecedente",NullType(),True),StructField("NumeroTrigger",IntegerType(),True),StructField("NotificationID_Triggerato",LongType(),True),StructField("NotificationChannel_Triggerato",StringType(),True),StructField("TipoMovimento_Triggerato",StringType(),True),StructField("CausaleMovimento_Triggerato",StringType(),True),StructField("NotificaStatus_Triggerato",StringType(),True),StructField("NotificationPrecedenteID_Triggerato",LongType(),True),StructField("NotificationPrecedenteChannel_Triggerato",StringType(),True),StructField("TipoMovimentoPrecedente_Triggerato",StringType(),True),StructField("CausaleMovimentoPrecedente_Triggerato",StringType(),True),StructField("NotificaStatusPrecedente_Triggerato",StringType(),True),StructField("NumeroTrigger_Triggerato",IntegerType(),True),StructField("TaxIDInternalContraentePolizza",StringType(),True),StructField("NomeCompagniaContraentePolizza",StringType(),True),StructField("NomeContraentePolizza",StringType(),True),StructField("CognomeContraentePolizza",StringType(),True),StructField("TaxIDInternalProprietarioVeicolo",StringType(),True),StructField("NomeCompagniaProprietarioVeicolo",StringType(),True),StructField("NomeContraenteProprietarioVeicolo",StringType(),True),StructField("CognomeContraenteProprietarioVeicolo",StringType(),True),StructField("Codice_IUR",StringType(),True),StructField("BlackBox",IntegerType(),True),StructField("TipoVeicoloANIA",StringType(),True),StructField("IsSubmission",IntegerType(),True),StructField("IsNextInstallment",IntegerType(),True),StructField("IsRenewal",IntegerType(),True),StructField("IsPolicyChange",IntegerType(),True),StructField("IsSuspension",IntegerType(),True),StructField("SuspensionTypeToInclude",IntegerType(),True),StructField("IsReactivation",IntegerType(),True),StructField("IsCancellation",IntegerType(),True),StructField("CancellationReasonCodeForA1",IntegerType(),True),StructField("CancellationReasonCodeForI1",IntegerType(),True),StructField("CancellationReasonCodeForI4",IntegerType(),True),StructField("CancellationReasonCodeForI5",IntegerType(),True),StructField("CancellationReasonCodeForI9",IntegerType(),True),StructField("CancellationReasonCodeForI6",IntegerType(),True),StructField("PolicyChangeReasonCodeToExclude",IntegerType(),True),StructField("EditEffectiveDate",TimestampType(),True),StructField("ChangeVehicleHour",StringType(),True),StructField("idrank",IntegerType(),True),StructField("df_name",StringType(),True)]),
'ab3_07_ania_sita_intermediate_triggers_10': StructType([StructField("ID_Policy_PC",LongType(),True),StructField("ID_PolicyPeriod_PC",LongType(),True),StructField("JobNumber",StringType(),True),StructField("Data_Chiusura_Transazione",TimestampType(),True),StructField("PolicyChangeReasonCode",NullType(),True),StructField("Numero_Polizza",StringType(),True),StructField("RegistrationNumber",StringType(),True),StructField("TipoMovimento",NullType(),True),StructField("CausaleMovimento",NullType(),True),StructField("TipoMovimentoPrecedente",NullType(),True),StructField("CausaleMovimentoPrecedente",NullType(),True),StructField("NumeroTrigger",IntegerType(),True),StructField("NotificationID_Triggerato",LongType(),True),StructField("NotificationChannel_Triggerato",StringType(),True),StructField("TipoMovimento_Triggerato",StringType(),True),StructField("CausaleMovimento_Triggerato",StringType(),True),StructField("NotificaStatus_Triggerato",StringType(),True),StructField("NotificationPrecedenteID_Triggerato",NullType(),True),StructField("NotificationPrecedenteChannel_Triggerato",NullType(),True),StructField("TipoMovimentoPrecedente_Triggerato",NullType(),True),StructField("CausaleMovimentoPrecedente_Triggerato",NullType(),True),StructField("NotificaStatusPrecedente_Triggerato",NullType(),True),StructField("NumeroTrigger_Triggerato",IntegerType(),True),StructField("TaxIDInternalContraentePolizza",StringType(),True),StructField("NomeCompagniaContraentePolizza",StringType(),True),StructField("NomeContraentePolizza",StringType(),True),StructField("CognomeContraentePolizza",StringType(),True),StructField("TaxIDInternalProprietarioVeicolo",StringType(),True),StructField("NomeCompagniaProprietarioVeicolo",StringType(),True),StructField("NomeContraenteProprietarioVeicolo",StringType(),True),StructField("CognomeContraenteProprietarioVeicolo",StringType(),True),StructField("Codice_IUR",StringType(),True),StructField("BlackBox",IntegerType(),True),StructField("TipoVeicoloANIA",StringType(),True),StructField("IsSubmission",IntegerType(),True),StructField("IsNextInstallment",IntegerType(),True),StructField("IsRenewal",IntegerType(),True),StructField("IsPolicyChange",IntegerType(),True),StructField("IsSuspension",IntegerType(),True),StructField("SuspensionTypeToInclude",IntegerType(),True),StructField("IsReactivation",IntegerType(),True),StructField("IsCancellation",IntegerType(),True),StructField("CancellationReasonCodeForA1",IntegerType(),True),StructField("CancellationReasonCodeForI1",IntegerType(),True),StructField("CancellationReasonCodeForI4",IntegerType(),True),StructField("CancellationReasonCodeForI5",IntegerType(),True),StructField("CancellationReasonCodeForI9",IntegerType(),True),StructField("CancellationReasonCodeForI6",IntegerType(),True),StructField("PolicyChangeReasonCodeToExclude",IntegerType(),True),StructField("EditEffectiveDate",TimestampType(),True),StructField("ChangeVehicleHour",StringType(),True),StructField("idrank",IntegerType(),True),StructField("df_name",StringType(),True)]),
'ab3_07_ania_sita_intermediate_triggers_11': StructType([StructField("ID_Policy_PC",LongType(),True),StructField("ID_PolicyPeriod_PC",LongType(),True),StructField("JobNumber",StringType(),True),StructField("Data_Chiusura_Transazione",TimestampType(),True),StructField("Numero_Polizza",StringType(),True),StructField("SuspensionTypeToInclude",IntegerType(),True),StructField("df_name",StringType(),True)]),
'ab3_07_ania_sita_intermediate_triggers_12': StructType([StructField("ID_Policy_PC",LongType(),True),StructField("ID_PolicyPeriod_PC",LongType(),True),StructField("JobNumber",StringType(),True),StructField("Data_Chiusura_Transazione",TimestampType(),True),StructField("Numero_Polizza",StringType(),True),StructField("RegistrationNumber",StringType(),True),StructField("TaxIDInternalContraentePolizza",StringType(),True),StructField("NomeCompagniaContraentePolizza",StringType(),True),StructField("NomeContraentePolizza",StringType(),True),StructField("CognomeContraentePolizza",StringType(),True),StructField("TaxIDInternalProprietarioVeicolo",StringType(),True),StructField("NomeCompagniaProprietarioVeicolo",StringType(),True),StructField("NomeContraenteProprietarioVeicolo",StringType(),True),StructField("CognomeContraenteProprietarioVeicolo",StringType(),True),StructField("Codice_IUR",StringType(),True),StructField("BlackBox",IntegerType(),True),StructField("TipoVeicoloANIA",StringType(),True),StructField("EditEffectiveDate",TimestampType(),True),StructField("ChangeVehicleHour",StringType(),True),StructField("df_name",StringType(),True)]),
'ab3_07_ania_sita_intermediate_triggers_13': StructType([StructField("ID_Policy_PC",LongType(),True),StructField("ID_PolicyPeriod_PC",LongType(),True),StructField("JobNumber",StringType(),True),StructField("Data_Chiusura_Transazione",TimestampType(),True),StructField("PolicyChangeReasonCode",StringType(),True),StructField("Numero_Polizza",StringType(),True),StructField("RegistrationNumber",StringType(),True),StructField("TipoMovimento",NullType(),True),StructField("CausaleMovimento",NullType(),True),StructField("TipoMovimentoPrecedente",NullType(),True),StructField("CausaleMovimentoPrecedente",NullType(),True),StructField("NumeroTrigger",IntegerType(),True),StructField("NotificationID_Triggerato",LongType(),True),StructField("NotificationChannel_Triggerato",StringType(),True),StructField("TipoMovimento_Triggerato",StringType(),True),StructField("CausaleMovimento_Triggerato",StringType(),True),StructField("NotificaStatus_Triggerato",StringType(),True),StructField("NotificationPrecedenteID_Triggerato",LongType(),True),StructField("NotificationPrecedenteChannel_Triggerato",StringType(),True),StructField("TipoMovimentoPrecedente_Triggerato",StringType(),True),StructField("CausaleMovimentoPrecedente_Triggerato",StringType(),True),StructField("NotificaStatusPrecedente_Triggerato",StringType(),True),StructField("NumeroTrigger_Triggerato",IntegerType(),True),StructField("TaxIDInternalContraentePolizza",StringType(),True),StructField("NomeCompagniaContraentePolizza",StringType(),True),StructField("NomeContraentePolizza",StringType(),True),StructField("CognomeContraentePolizza",StringType(),True),StructField("TaxIDInternalProprietarioVeicolo",StringType(),True),StructField("NomeCompagniaProprietarioVeicolo",StringType(),True),StructField("NomeContraenteProprietarioVeicolo",StringType(),True),StructField("CognomeContraenteProprietarioVeicolo",StringType(),True),StructField("Codice_IUR",StringType(),True),StructField("BlackBox",IntegerType(),True),StructField("TipoVeicoloANIA",StringType(),True),StructField("IsSubmission",IntegerType(),True),StructField("IsNextInstallment",IntegerType(),True),StructField("IsRenewal",IntegerType(),True),StructField("IsPolicyChange",IntegerType(),True),StructField("IsSuspension",IntegerType(),True),StructField("SuspensionTypeToInclude",IntegerType(),True),StructField("IsReactivation",IntegerType(),True),StructField("IsCancellation",IntegerType(),True),StructField("CancellationReasonCodeForA1",IntegerType(),True),StructField("CancellationReasonCodeForI1",IntegerType(),True),StructField("CancellationReasonCodeForI4",IntegerType(),True),StructField("CancellationReasonCodeForI5",IntegerType(),True),StructField("CancellationReasonCodeForI9",IntegerType(),True),StructField("CancellationReasonCodeForI6",IntegerType(),True),StructField("PolicyChangeReasonCodeToExclude",IntegerType(),True),StructField("EditEffectiveDate",TimestampType(),True),StructField("ChangeVehicleHour",StringType(),True),StructField("idrank",IntegerType(),True),StructField("df_name",StringType(),True)]),
'ab3_07_ania_sita_triggers':''}